define(["../ThirdParty/when","./CompressedTextureBuffer","./defined","./DeveloperError","./Resource","./TaskProcessor"],function(e,r,f,n,t,u){"use strict";var s=new u("transcodeCRNToDXT",Number.POSITIVE_INFINITY);return function(u){if(!f(u))throw new n("resourceOrUrlOrBuffer is required.");var i;if(i=u instanceof ArrayBuffer||ArrayBuffer.isView(u)?e.resolve(u):t.createIfNeeded(u).fetchArrayBuffer(),f(i))return i.then(function(e){if(f(e)){var r=[];return e instanceof ArrayBuffer?r.push(e):0===e.byteOffset&&e.byteLength===e.buffer.byteLength?r.push(e.buffer):(e=e.slice(0,e.length),r.push(e.buffer)),s.scheduleTask(e,r)}}).then(function(e){return r.clone(e)})}});