define(["../../Core/Color","../../Core/defined","../../Core/DeveloperError","../../Core/Cartesian3","../../Core/JulianDate","../../DataSources/Entity","../core/Color"],function(e,t,i,o,n,r,a){function l(l){var s,c,d=document.createElement("canvas"),h=d.getContext("2d");d.height=4,d.width=4,h.fillStyle=l.pointStyle.color,h.arc(2,2,2,0,2*Math.PI,!1),h.fill(),s=d.toDataURL(),this.entityCollection=c=l.viewer.entities.add(new r),l.viewer.clockViewModel.shouldAnimate=!0;var m=l.points.map(function(e,t,i){return{coordinates:e,time:t}}),f={start:0,end:m.length},u=15,v=f.end-f.start,C=function(e){if(!t(e))throw new i("time is required.");var o=n.toDate(e).getTime()/u%v+f.start,r=r||10;return!!(o&&this.nameID>o-r&&this.nameID<o)},w=[],g=l.pointStyle,p=new e(243/255,242/255,249/255,.8),y=5;g&&(g.color&&(p=a(g.color)),g.size&&(y=g.size));for(var D=0;D<m.length;++D){var E=m[D].coordinates[0],I=m[D].coordinates[1];w[D]=l.viewer.entities.add({parent:c,position:o.fromDegrees(E,I,l.height),nameID:m[D].time,billboard:{image:s,width:y,height:y,color:p}}),w[D].isAvailable=C}}return l.prototype.destroy=function(e){this.entityCollection._children.forEach(function(t,i,o){e.entities.remove(t)}),e.entities.remove(this.entityCollection)},l});