define(["./Check","./RuntimeError"],function(t,e){"use strict";var n=1953029805,i=2917034100;function r(a,g){if(r.passThroughDataForTesting)return g;t.typeOf.object("key",a),t.typeOf.object("data",g);var o=a.byteLength;if(0===o||o%4!=0)throw new e("The length of key must be greater than 0 and a multiple of 4.");var f=new DataView(g),s=f.getUint32(0,!0);if(s===n||s===i)return g;for(var h,u=new DataView(a),U=0,c=g.byteLength,w=c-c%8,y=o,b=8;U<w;)for(h=b=(b+8)%24;U<w&&h<y;)f.setUint32(U,f.getUint32(U,!0)^u.getUint32(h,!0),!0),f.setUint32(U+4,f.getUint32(U+4,!0)^u.getUint32(h+4,!0),!0),U+=8,h+=24;if(U<c)for(h>=y&&(h=b=(b+8)%24);U<c;)f.setUint8(U,f.getUint8(U)^u.getUint8(h)),U++,h++}return r.passThroughDataForTesting=!1,r});