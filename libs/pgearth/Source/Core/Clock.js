define(["./ClockRange","./ClockStep","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./getTimestamp","./JulianDate"],function(t,e,i,s,n,o,c,r,h){"use strict";function l(n){var l=(n=i(n,i.EMPTY_OBJECT)).currentTime,a=n.startTime,u=n.stopTime;if(l=s(l)?h.clone(l):s(a)?h.clone(a):s(u)?h.addDays(u,-1,new h):h.now(),a=s(a)?h.clone(a):h.clone(l),u=s(u)?h.clone(u):h.addDays(a,1,new h),h.greaterThan(a,u))throw new o("startTime must come before stopTime.");this.startTime=a,this.stopTime=u,this.clockRange=i(n.clockRange,t.UNBOUNDED),this.canAnimate=i(n.canAnimate,!0),this.onTick=new c,this.onStop=new c,this._currentTime=void 0,this._multiplier=void 0,this._clockStep=void 0,this._shouldAnimate=void 0,this._lastSystemTime=r(),this.currentTime=l,this.multiplier=i(n.multiplier,1),this.shouldAnimate=i(n.shouldAnimate,!1),this.clockStep=i(n.clockStep,e.SYSTEM_CLOCK_MULTIPLIER)}return n(l.prototype,{currentTime:{get:function(){return this._currentTime},set:function(t){h.equals(this._currentTime,t)||(this._clockStep===e.SYSTEM_CLOCK&&(this._clockStep=e.SYSTEM_CLOCK_MULTIPLIER),this._currentTime=t)}},multiplier:{get:function(){return this._multiplier},set:function(t){this._multiplier!==t&&(this._clockStep===e.SYSTEM_CLOCK&&(this._clockStep=e.SYSTEM_CLOCK_MULTIPLIER),this._multiplier=t)}},clockStep:{get:function(){return this._clockStep},set:function(t){t===e.SYSTEM_CLOCK&&(this._multiplier=1,this._shouldAnimate=!0,this._currentTime=h.now()),this._clockStep=t}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(t){this._shouldAnimate!==t&&(this._clockStep===e.SYSTEM_CLOCK&&(this._clockStep=e.SYSTEM_CLOCK_MULTIPLIER),this._shouldAnimate=t)}}}),l.prototype.tick=function(){var i=r(),s=h.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){var n=this._clockStep;if(n===e.SYSTEM_CLOCK)s=h.now(s);else{var o=this._multiplier;if(n===e.TICK_DEPENDENT)s=h.addSeconds(s,o,s);else{var c=i-this._lastSystemTime;s=h.addSeconds(s,o*(c/1e3),s)}var l=this.clockRange,a=this.startTime,u=this.stopTime;if(l===t.CLAMPED)h.lessThan(s,a)?s=h.clone(a,s):h.greaterThan(s,u)&&(s=h.clone(u,s),this.onStop.raiseEvent(this));else if(l===t.LOOP_STOP)for(h.lessThan(s,a)&&(s=h.clone(a,s));h.greaterThan(s,u);)s=h.addSeconds(a,h.secondsDifference(s,u),s),this.onStop.raiseEvent(this)}}return this._currentTime=s,this._lastSystemTime=i,this.onTick.raiseEvent(this),s},l});