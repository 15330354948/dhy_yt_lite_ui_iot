define([],function(){"use strict";function t(t,h,i,s,u){h=h||r,i=i||o,u=u||Array,this.nodeSize=s||64,this.points=t,this.ids=new u(t.length),this.coords=new u(2*t.length);for(var e=0;e<t.length;e++)this.ids[e]=e,this.coords[2*e]=h(t[e]),this.coords[2*e+1]=i(t[e]);!function t(r,o,h,i,s,u){if(s-i<=h)return;var e=Math.floor((i+s)/2);!function t(r,o,h,i,s,u){for(;s>i;){if(s-i>600){var e=s-i+1,f=h-i+1,p=Math.log(e),a=.5*Math.exp(2*p/3),c=.5*Math.sqrt(p*a*(e-a)/e)*(f-e/2<0?-1:1),d=Math.max(i,Math.floor(h-f*a/e+c)),l=Math.min(s,Math.floor(h+(e-f)*a/e+c));t(r,o,h,d,l,u)}var v=o[2*h+u],g=i,M=s;for(n(r,o,i,h),o[2*s+u]>v&&n(r,o,i,s);g<M;){for(n(r,o,g,M),g++,M--;o[2*g+u]<v;)g++;for(;o[2*M+u]>v;)M--}o[2*i+u]===v?n(r,o,i,M):n(r,o,++M,s),M<=h&&(i=M+1),h<=M&&(s=M-1)}}(r,o,e,i,s,u%2);t(r,o,h,i,e-1,u+1);t(r,o,h,e+1,s,u+1)}(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function r(t){return t[0]}function o(t){return t[1]}function n(t,r,o,n){h(t,o,n),h(r,2*o,2*n),h(r,2*o+1,2*n+1)}function h(t,r,o){var n=t[r];t[r]=t[o],t[o]=n}function i(t,r,o,n){var h=t-o,i=r-n;return h*h+i*i}return t.prototype={range:function(t,r,o,n){return function(t,r,o,n,h,i,s){var u,e,f=[0,t.length-1,0],p=[];for(;f.length;){var a=f.pop(),c=f.pop(),d=f.pop();if(c-d<=s)for(var l=d;l<=c;l++)u=r[2*l],e=r[2*l+1],u>=o&&u<=h&&e>=n&&e<=i&&p.push(t[l]);else{var v=Math.floor((d+c)/2);u=r[2*v],e=r[2*v+1],u>=o&&u<=h&&e>=n&&e<=i&&p.push(t[v]);var g=(a+1)%2;(0===a?o<=u:n<=e)&&(f.push(d),f.push(v-1),f.push(g)),(0===a?h>=u:i>=e)&&(f.push(v+1),f.push(c),f.push(g))}}return p}(this.ids,this.coords,t,r,o,n,this.nodeSize)},within:function(t,r,o){return function(t,r,o,n,h,s){var u=[0,t.length-1,0],e=[],f=h*h;for(;u.length;){var p=u.pop(),a=u.pop(),c=u.pop();if(a-c<=s)for(var d=c;d<=a;d++)i(r[2*d],r[2*d+1],o,n)<=f&&e.push(t[d]);else{var l=Math.floor((c+a)/2),v=r[2*l],g=r[2*l+1];i(v,g,o,n)<=f&&e.push(t[l]);var M=(p+1)%2;(0===p?o-h<=v:n-h<=g)&&(u.push(c),u.push(l-1),u.push(M)),(0===p?o+h>=v:n+h>=g)&&(u.push(l+1),u.push(a),u.push(M))}}return e}(this.ids,this.coords,t,r,o,this.nodeSize)}},function(r,o,n,h,i){return new t(r,o,n,h,i)}});