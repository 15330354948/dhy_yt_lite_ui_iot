define(["../Core/ComponentDatatype","../Core/defaultValue","../Core/defined"],function(e,t,r){"use strict";function f(e,t){this.json=e,this.buffer=t,this._cachedTypedArrays={},this.featuresLength=0}function n(t,f,n,o,s,a){var i=t._cachedTypedArrays,y=i[f];return r(y)||(y=e.createArrayBufferView(n,t.buffer.buffer,t.buffer.byteOffset+a,s*o),i[f]=y),y}return f.prototype.getGlobalProperty=function(f,o,s){var a=this.json[f];if(r(a))return r(a.byteOffset)?n(this,f,o=t(o,e.UNSIGNED_INT),s=t(s,1),1,a.byteOffset):a},f.prototype.getPropertyArray=function(t,f,o){var s=this.json[t];if(r(s))return r(s.byteOffset)?(r(s.componentType)&&(f=e.fromName(s.componentType)),n(this,t,f,o,this.featuresLength,s.byteOffset)):function(t,f,n,o){var s=t._cachedTypedArrays,a=s[f];return r(a)||(a=e.createTypedArray(n,o),s[f]=a),a}(this,t,f,s)},f.prototype.getProperty=function(e,t,f,n,o){var s=this.json[e];if(r(s)){var a=this.getPropertyArray(e,t,f);if(1===f)return a[n];for(var i=0;i<f;++i)o[i]=a[f*n+i];return o}},f});