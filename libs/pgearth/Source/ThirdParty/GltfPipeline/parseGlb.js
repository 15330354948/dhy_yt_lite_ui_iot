define(["./addPipelineExtras","./removeExtensionsUsed","../../Core/defaultValue","../../Core/defined","../../Core/getMagic","../../Core/getStringFromTypedArray","../../Core/RuntimeError"],function(r,e,n,i,a,t,o){"use strict";var f=4;function s(r,e,n){for(var i=new DataView(r.buffer),a=new Array(n),t=0;t<n;++t)a[t]=i.getUint32(r.byteOffset+e+t*f,!0);return a}return function(f){if("glTF"!==a(f))throw new o("File is not valid binary glTF");var u=s(f,0,5),l=u[1];if(1!==l&&2!==l)throw new o("Binary glTF version is not 1 or 2");return 1===l?function(a,f){var s=f[2],u=f[3];if(0!==f[4])throw new o("Binary glTF scene format is not JSON");var l=20+u,v=t(a,20,u),g=JSON.parse(v);r(g);var y=a.subarray(l,s),b=g.buffers;if(i(b)&&Object.keys(b).length>0){var c=n(b.binary_glTF,b.KHR_binary_glTF);i(c)&&(c.extras._pipeline.source=y)}return e(g,"KHR_binary_glTF"),g}(f,u):function(e,n){for(var a,o,f=n[2],u=12;u<f;){var l=s(e,u,2),v=l[0],g=l[1];u+=8;var y=e.subarray(u,u+v);if(u+=v,1313821514===g){var b=t(y);a=JSON.parse(b),r(a)}else 5130562===g&&(o=y)}if(i(a)&&i(o)){var c=a.buffers;if(i(c)&&c.length>0){var d=c[0];d.extras._pipeline.source=o}}return a}(f,u)}});