define(["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/NearFarScalar","./SceneMode","./SceneTransforms"],function(t,i,e,n,s,o,r,a,c,l,h,u,_,d){"use strict";function p(t,i){if(t=o(t,o.EMPTY_OBJECT),r(t.disableDepthTestDistance)&&t.disableDepthTestDistance<0)throw new c("disableDepthTestDistance must be greater than or equal to 0.0.");var n=t.translucencyByDistance,a=t.scaleByDistance,h=t.distanceDisplayCondition;if(r(n)){if(n.far<=n.near)throw new c("translucencyByDistance.far must be greater than translucencyByDistance.near.");n=u.clone(n)}if(r(a)){if(a.far<=a.near)throw new c("scaleByDistance.far must be greater than scaleByDistance.near.");a=u.clone(a)}if(r(h)){if(h.far<=h.near)throw new c("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.");h=l.clone(h)}this._show=o(t.show,!0),this._position=e.clone(o(t.position,e.ZERO)),this._actualPosition=e.clone(this._position),this._color=s.clone(o(t.color,s.WHITE)),this._outlineColor=s.clone(o(t.outlineColor,s.TRANSPARENT)),this._outlineWidth=o(t.outlineWidth,0),this._pixelSize=o(t.pixelSize,10),this._scaleByDistance=a,this._translucencyByDistance=n,this._distanceDisplayCondition=h,this._disableDepthTestDistance=o(t.disableDepthTestDistance,0),this._id=t.id,this._collection=o(t.collection,i),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=i,this._dirty=!1,this._index=-1}var D=p.SHOW_INDEX=0,f=p.POSITION_INDEX=1,y=p.COLOR_INDEX=2,w=p.OUTLINE_COLOR_INDEX=3,C=p.OUTLINE_WIDTH_INDEX=4,I=p.PIXEL_SIZE_INDEX=5,S=p.SCALE_BY_DISTANCE_INDEX=6,E=p.TRANSLUCENCY_BY_DISTANCE_INDEX=7,P=p.DISTANCE_DISPLAY_CONDITION_INDEX=8,g=p.DISABLE_DEPTH_DISTANCE_INDEX=9;function v(t,i){var e=t._pointPrimitiveCollection;r(e)&&(e._updatePointPrimitive(t,i),t._dirty=!0)}p.NUMBER_OF_PROPERTIES=10,a(p.prototype,{show:{get:function(){return this._show},set:function(t){if(!r(t))throw new c("value is required.");this._show!==t&&(this._show=t,v(this,D))}},position:{get:function(){return this._position},set:function(t){if(!r(t))throw new c("value is required.");var i=this._position;e.equals(i,t)||(e.clone(t,i),e.clone(t,this._actualPosition),v(this,f))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(t){if(r(t)&&t.far<=t.near)throw new c("far distance must be greater than near distance.");var i=this._scaleByDistance;u.equals(i,t)||(this._scaleByDistance=u.clone(t,i),v(this,S))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(t){if(r(t)&&t.far<=t.near)throw new c("far distance must be greater than near distance.");var i=this._translucencyByDistance;u.equals(i,t)||(this._translucencyByDistance=u.clone(t,i),v(this,E))}},pixelSize:{get:function(){return this._pixelSize},set:function(t){if(!r(t))throw new c("value is required.");this._pixelSize!==t&&(this._pixelSize=t,v(this,I))}},color:{get:function(){return this._color},set:function(t){if(!r(t))throw new c("value is required.");var i=this._color;s.equals(i,t)||(s.clone(t,i),v(this,y))}},outlineColor:{get:function(){return this._outlineColor},set:function(t){if(!r(t))throw new c("value is required.");var i=this._outlineColor;s.equals(i,t)||(s.clone(t,i),v(this,w))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(t){if(!r(t))throw new c("value is required.");this._outlineWidth!==t&&(this._outlineWidth=t,v(this,C))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(t){if(r(t)&&t.far<=t.near)throw new c("far must be greater than near");l.equals(this._distanceDisplayCondition,t)||(this._distanceDisplayCondition=l.clone(t,this._distanceDisplayCondition),v(this,P))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(t){if(this._disableDepthTestDistance!==t){if(!r(t)||t<0)throw new c("disableDepthTestDistance must be greater than or equal to 0.0.");this._disableDepthTestDistance=t,v(this,g)}}},id:{get:function(){return this._id},set:function(t){this._id=t,r(this._pickId)&&(this._pickId.object.id=t)}},pickId:{get:function(){return this._pickId}},clusterShow:{get:function(){return this._clusterShow},set:function(t){this._clusterShow!==t&&(this._clusterShow=t,v(this,D))}}}),p.prototype.getPickId=function(t){return r(this._pickId)||(this._pickId=t.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId},p.prototype._getActualPosition=function(){return this._actualPosition},p.prototype._setActualPosition=function(t){e.clone(t,this._actualPosition),v(this,f)};var T=new n;p._computeActualPosition=function(t,i,e){return i.mode===_.SCENE3D?t:(h.multiplyByPoint(e,t,T),d.computeActualWgs84Position(i,T))};var B=new n;return p._computeScreenSpacePosition=function(t,i,e,s){var o=h.multiplyByVector(t,n.fromElements(i.x,i.y,i.z,1,B),B);return d.wgs84ToWindowCoordinates(e,o,s)},p.prototype.computeScreenSpacePosition=function(t,e){var n=this._pointPrimitiveCollection;if(r(e)||(e=new i),!r(n))throw new c("PointPrimitive must be in a collection.");if(!r(t))throw new c("scene is required.");var s=n.modelMatrix,o=p._computeScreenSpacePosition(s,this._actualPosition,t,e);if(r(o))return o.y=t.canvas.clientHeight-o.y,o},p.getScreenSpaceBoundingBox=function(i,e,n){var s=i.pixelSize,o=.5*s,a=e.x-o,c=e.y-o,l=s,h=s;return r(n)||(n=new t),n.x=a,n.y=c,n.width=l,n.height=h,n},p.prototype.equals=function(t){return this===t||r(t)&&this._id===t._id&&e.equals(this._position,t._position)&&s.equals(this._color,t._color)&&this._pixelSize===t._pixelSize&&this._outlineWidth===t._outlineWidth&&this._show===t._show&&s.equals(this._outlineColor,t._outlineColor)&&u.equals(this._scaleByDistance,t._scaleByDistance)&&u.equals(this._translucencyByDistance,t._translucencyByDistance)&&l.equals(this._distanceDisplayCondition,t._distanceDisplayCondition)&&this._disableDepthTestDistance===t._disableDepthTestDistance},p.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0},p});