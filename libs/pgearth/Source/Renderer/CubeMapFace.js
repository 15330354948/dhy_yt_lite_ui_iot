define(["../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/PixelFormat","./PixelDatatype"],function(e,t,i,r,a,s,h){"use strict";function _(e,t,i,r,a,s,h,_,l,o){this._gl=e,this._texture=t,this._textureTarget=i,this._targetFace=r,this._pixelFormat=a,this._pixelDatatype=s,this._size=h,this._preMultiplyAlpha=_,this._flipY=l,this._initialized=o}return r(_.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}}),_.prototype.copyFrom=function(r,h,_){if(h=t(h,0),_=t(_,0),e.defined("source",r),e.typeOf.number.greaterThanOrEquals("xOffset",h,0),e.typeOf.number.greaterThanOrEquals("yOffset",_,0),h+r.width>this._size)throw new a("xOffset + source.width must be less than or equal to width.");if(_+r.height>this._size)throw new a("yOffset + source.height must be less than or equal to height.");var l=this._gl,o=this._textureTarget,u=this._targetFace;l.activeTexture(l.TEXTURE0),l.bindTexture(o,this._texture);var f=r.width,n=r.height,p=r.arrayBufferView,x=this._size,L=this._pixelFormat,P=this._pixelDatatype,g=this._preMultiplyAlpha,y=this._flipY,m=4;i(p)&&(m=s.alignmentInBytes(L,P,f)),l.pixelStorei(l.UNPACK_ALIGNMENT,m);var A=!1;if(!this._initialized){if(0===h&&0===_&&f===x&&n===x)i(p)?(l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!1),y&&(p=s.flipY(p,L,P,x,x)),l.texImage2D(u,0,L,x,x,0,L,P,p)):(l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,g),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,y),l.texImage2D(u,0,L,L,P,r)),A=!0;else{l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!1);var T=s.createTypedArray(L,P,x,x);l.texImage2D(u,0,L,x,x,0,L,P,T)}this._initialized=!0}A||(i(p)?(l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,!1),y&&(p=s.flipY(p,L,P,f,n)),l.texSubImage2D(u,0,h,_,f,n,L,P,p)):(l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,g),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,y),l.texSubImage2D(u,0,h,_,L,P,r))),l.bindTexture(o,null)},_.prototype.copyFromFramebuffer=function(i,r,s,_,l,o){if(i=t(i,0),r=t(r,0),s=t(s,0),_=t(_,0),l=t(l,this._size),o=t(o,this._size),e.typeOf.number.greaterThanOrEquals("xOffset",i,0),e.typeOf.number.greaterThanOrEquals("yOffset",r,0),e.typeOf.number.greaterThanOrEquals("framebufferXOffset",s,0),e.typeOf.number.greaterThanOrEquals("framebufferYOffset",_,0),i+l>this._size)throw new a("xOffset + source.width must be less than or equal to width.");if(r+o>this._size)throw new a("yOffset + source.height must be less than or equal to height.");if(this._pixelDatatype===h.FLOAT)throw new a("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===h.HALF_FLOAT)throw new a("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");var u=this._gl,f=this._textureTarget;u.activeTexture(u.TEXTURE0),u.bindTexture(f,this._texture),u.copyTexSubImage2D(this._targetFace,0,i,r,s,_,l,o),u.bindTexture(f,null),this._initialized=!0},_});