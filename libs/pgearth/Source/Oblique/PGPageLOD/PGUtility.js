define(["../../Core/Cartesian3","../../Core/Cartesian4","../../Core/Matrix4"],function(r,t,e){"use strict";function n(){}return n.preDealPath=function(r,t){var e=r.substr(0);if(e.trim(),e.replace("\\","/"),e.length>=2&&("//"==e.substr(0,2)&&(e[0]="\\",e[1]="\\"),e.replace("//","/"),e.length>5&&"http:"==e.substr(0,5))){for(var n=5;n<e.length&&"/"==e.charAt(n);n++);e="http://"+e.substr(n,e.length-n)}if(!t){for(var s=e.length-1;s>=0&&"/"==e.charAt(s);)s--;e=e.substr(0,s+1),e+="/"}return e},n.getDir=function(r){var t=(r.length,r.lastIndexOf("/"));if(t<0&&(t=r.lastIndexOf("\\")),t<0)return r.substr(0);var e=r.substr(0,t);return"/"!=e.charAt(e.length-1)&&(e+="/"),e},n.getAbsolutePath=function(r,t){var e,s=r.substr(0),u=t.substr(0);if(s.trim(),u.trim(),""==s){if("./"==(e=u.substr(0,2))||".\\"==e)return u.substr(2);if("../"==(e=u.substr(0,3))||"..\\"==e)return""}if(""==u)return u;if(u.length>=2&&":"==u.charAt(1)||u.length>=5&&":"==u.charAt(4))return u;if("\\\\"==(e=u.substr(0,2))||"//"==e)return u;s=n.preDealPath(s,!1),e=(u=n.preDealPath(u,!0)).substr(0,2);var i=u.substr(0,3);if("./"==e)return s+(u=u.substr(2));if(u.length>=2&&":"==u.charAt(1))return u;if("/"!=u.charAt(0)&&"../"!=i)return s+u;if("/"==u.charAt(0))return u;if("../"==i){var a=0;do{a=s.lastIndexOf("/"),s=s.substr(0,a),u=u.substr(3)}while("../"==u.substr(0,3));return s+"/"+u}return r},n.project=function(n,s,u){var i=new t;i.x=n.x,i.y=n.y,i.z=n.z,i.w=1;var a=new e;e.multiply(s.workingFrustums[0].projectionMatrix,s.viewMatrix,a);var h=new t;if(e.multiplyByVector(a,i,h),0!=h.w){h.x/=h.w,h.y/=h.w,h.z/=h.w,h.x=.5*h.x+.5,h.y=.5*h.y+.5,h.z=.5*h.z+.5;var f=new r;return f.x=h.x*u.width+u.x,f.y=h.y*u.height+u.y,f.z=h.z,f}},n});