define(["../Core/Check","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DeveloperError","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/GeometryInstance","../Core/Iso8601","../Core/PolylineVolumeGeometry","../Core/PolylineVolumeOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","./ColorMaterialProperty","./DynamicGeometryUpdater","./GeometryUpdater","./Property"],function(e,t,o,i,n,r,s,a,l,p,y,c,u,d,h,m,C){"use strict";var _=new t;function f(e,t){m.call(this,{entity:e,scene:t,geometryOptions:new function(e){this.id=e,this.vertexFormat=void 0,this.polylinePositions=void 0,this.shapePositions=void 0,this.cornerType=void 0,this.granularity=void 0}(e),geometryPropertyName:"polylineVolume",observedPropertyNames:["availability","polylineVolume"]}),this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,void 0)}function g(e,t,o){h.call(this,e,t,o)}return i(Object.create)&&(f.prototype=Object.create(m.prototype),f.prototype.constructor=f),f.prototype.createFillGeometryInstance=function(a){if(e.defined("time",a),!this._fillEnabled)throw new n("This instance does not represent a filled geometry.");var p,c,u=this._entity,h=u.isAvailable(a),m=new y(h&&u.isShowing&&this._showProperty.getValue(a)&&this._fillProperty.getValue(a)),C=this._distanceDisplayConditionProperty.getValue(a),f=r.fromDistanceDisplayCondition(C);this._materialProperty instanceof d?(i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||h)&&(c=this._materialProperty.color.getValue(a,_)),i(c)||(c=t.WHITE),p={show:m,distanceDisplayCondition:f,color:o.fromColor(c)}):p={show:m,distanceDisplayCondition:f};return new s({id:u,geometry:new l(this._options),attributes:p})},f.prototype.createOutlineGeometryInstance=function(i){if(e.defined("time",i),!this._outlineEnabled)throw new n("This instance does not represent an outlined geometry.");var a=this._entity,l=a.isAvailable(i),c=C.getValueOrDefault(this._outlineColorProperty,i,t.BLACK,_),u=this._distanceDisplayConditionProperty.getValue(i);return new s({id:a,geometry:new p(this._options),attributes:{show:new y(l&&a.isShowing&&this._showProperty.getValue(i)&&this._showOutlineProperty.getValue(i)),color:o.fromColor(c),distanceDisplayCondition:r.fromDistanceDisplayCondition(u)}})},f.prototype._isHidden=function(e,t){return!i(t.positions)||!i(t.shape)||m.prototype._isHidden.call(this,e,t)},f.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&t.shape.isConstant&&C.isConstant(t.granularity)&&C.isConstant(t.outlineWidth)&&C.isConstant(t.cornerType))},f.prototype._setStaticOptions=function(e,t){var o=t.granularity,n=t.cornerType,r=this._options,s=this._materialProperty instanceof d;r.vertexFormat=s?u.VERTEX_FORMAT:c.MaterialSupport.TEXTURED.vertexFormat,r.polylinePositions=t.positions.getValue(a.MINIMUM_VALUE,r.polylinePositions),r.shapePositions=t.shape.getValue(a.MINIMUM_VALUE,r.shape),r.granularity=i(o)?o.getValue(a.MINIMUM_VALUE):void 0,r.cornerType=i(n)?n.getValue(a.MINIMUM_VALUE):void 0},f.DynamicGeometryUpdater=g,i(Object.create)&&(g.prototype=Object.create(h.prototype),g.prototype.constructor=g),g.prototype._isHidden=function(e,t,o){var n=this._options;return!i(n.polylinePositions)||!i(n.shapePositions)||h.prototype._isHidden.call(this,e,t,o)},g.prototype._setOptions=function(e,t,o){var i=this._options;i.polylinePositions=C.getValueOrUndefined(t.positions,o,i.polylinePositions),i.shapePositions=C.getValueOrUndefined(t.shape,o),i.granularity=C.getValueOrUndefined(t.granularity,o),i.cornerType=C.getValueOrUndefined(t.cornerType,o)},f});