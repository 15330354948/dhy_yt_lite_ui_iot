define(["../layers/GraphicsLayer","../others/EventDrive","../symbols/TextSymbol","../symbols/PrimitiveSymbol","../Graphic","../_Color","../../Source/Scene/LabelStyle","../../Source/Scene/HorizontalOrigin","../../Source/Scene/VerticalOrigin","../../Source/Core/Cartesian3"],function(e,i,t,s,o,l,h,r,n,a){function c(t){this.viewer=t.viewer,this.layer=new e,this.circles=[],this.path=[],this.height=[],this.lines=null,this.label=[],this.point=this.viewer.entities.add({point:{color:Color.RED,pixelSize:10}}),this.labelTotle=this.viewer.entities.add({label:{show:!1,showBackground:!0,font:"36px Helvetica",fillColor:l("WHITE"),outlineColor:l("BACK"),outlineWidth:5,style:h.FILL_AND_OUTLINE,horizontalOrigin:r.CENTER,verticalOrigin:n.BASELINE,disableDepthTestDistance:1e4,scale:.5}}),this.event=new i({viewer:this.viewer,eventType:"left_click",callBack:e=>{let i=this.path,t=this.movePoint.mapPoint.longitude,c=this.movePoint.mapPoint.latitude,p=this.movePoint.mapPoint.height,v=0,d=0;if(p<-50)return;i.push(t,c),this.height.push(p);let w=i.length,m=new o({symbol:{type:"point-3d",style:{type:"cone",height:60,width:30,color:"#4af99d"}},geometry:{type:"point",longitude:t,latitude:c,height:p+30}}),u=new s({type:"circle",center:[t,c],radius:.5,color:"#4af99d",class:"both"}),g=new s({type:"line",ranges:i,color:"red",width:1,class:"both"});if(this.layer.add(m),this.viewer.map.remove(this.lines),this.circles.push(u),this.lines=g,this.viewer.map.add(g),this.viewer.map.add(u),w>=4){for(let e=w-1;e>=3;e-=2)v+=Math.sqrt(a.distanceSquared(new a.fromDegrees(i[e-1],i[e]),new a.fromDegrees(i[e-3],i[e-2])));d=Math.sqrt(a.distanceSquared(new a.fromDegrees(i[w-2],i[w-1]),new a.fromDegrees(i[w-4],i[w-3]))),this.labelTotle.position=new a.fromDegrees(i[0],i[1],this.height[0]+10),this.labelTotle.show=!0,this.labelTotle.label.show=!0,this.labelTotle.label.text="总长:"+v.toFixed(2)+"米";let e=this.viewer.entities.add({show:!0,position:new a.fromDegrees((i[w-2]+i[w-4])/2,(i[w-1]+i[w-3])/2,this.height[w/2-1]+10),label:{show:!0,text:d.toFixed(2)+"米",showBackground:!0,font:"36px Helvetica",fillColor:l("WHITE"),outlineColor:l("BACK"),outlineWidth:5,style:h.FILL_AND_OUTLINE,horizontalOrigin:r.CENTER,verticalOrigin:n.BASELINE,disableDepthTestDistance:1e4,scale:.5}});this.label.push(e)}this.viewer.scene.requestRenderMode=!1}}),this.mouseMove=new i({eventType:"mouse_move",viewer:t.viewer,callBack:e=>{this.movePoint=e,this.point&&(this.point.position=e.cartesian)}})}return c.prototype.destroy=function(){this.viewer.entities.remove(this.labelTotle),this.viewer.entities.remove(this.point),this.label.forEach(e=>this.viewer.entities.remove(e)),this.viewer.map.remove(this.lines),this.circles.forEach(e=>this.viewer.map.remove(e)),this.event.destroy(),this.mouseMove.destroy(),this.height=[],this.circles=[],this.point=null,this.path=[],this.lines=null},c});