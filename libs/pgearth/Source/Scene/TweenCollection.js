define(["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/EasingFunction","../Core/getTimestamp","../Core/TimeConstants","../ThirdParty/Tween"],function(t,e,n,r,o,i,a,s,u){"use strict";function p(e,n,r,o,i,a,s,u,p,c){this._tweens=e,this._tweenjs=n,this._startObject=t(r),this._stopObject=t(o),this._duration=i,this._delay=a,this._easingFunction=s,this._update=u,this._complete=p,this.cancel=c,this.needsStart=!0}function c(){this._tweens=[]}return r(p.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}}),p.prototype.cancelTween=function(){this._tweens.remove(this)},r(c.prototype,{length:{get:function(){return this._tweens.length}}}),c.prototype.add=function(r){if(r=e(r,e.EMPTY_OBJECT),!n(r.startObject)||!n(r.stopObject))throw new o("options.startObject and options.stopObject are required.");if(!n(r.duration)||r.duration<0)throw new o("options.duration is required and must be positive.");if(0===r.duration)return n(r.complete)&&r.complete(),new p(this);var a=r.duration/s.SECONDS_PER_MILLISECOND,c=e(r.delay,0),d=c/s.SECONDS_PER_MILLISECOND,l=e(r.easingFunction,i.LINEAR_NONE),f=r.startObject,h=new u.Tween(f);h.to(t(r.stopObject),a),h.delay(d),h.easing(l),n(r.update)&&h.onUpdate(function(){r.update(f)}),h.onComplete(e(r.complete,null)),h.repeat(e(r._repeat,0));var w=new p(this,h,r.startObject,r.stopObject,r.duration,c,l,r.update,r.complete,r.cancel);return this._tweens.push(w),w},c.prototype.addProperty=function(t){var r=(t=e(t,e.EMPTY_OBJECT)).object,i=t.property,a=t.startValue,s=t.stopValue;if(!n(r)||!n(t.property))throw new o("options.object and options.property are required.");if(!n(r[i]))throw new o("options.object must have the specified property.");if(!n(a)||!n(s))throw new o("options.startValue and options.stopValue are required.");return this.add({startObject:{value:a},stopObject:{value:s},duration:e(t.duration,3),delay:t.delay,easingFunction:t.easingFunction,update:function(t){r[i]=t.value},complete:t.complete,cancel:t.cancel,_repeat:t._repeat})},c.prototype.addAlpha=function(t){var r=(t=e(t,e.EMPTY_OBJECT)).material;if(!n(r))throw new o("options.material is required.");var i=[];for(var a in r.uniforms)r.uniforms.hasOwnProperty(a)&&n(r.uniforms[a])&&n(r.uniforms[a].alpha)&&i.push(a);if(0===i.length)throw new o("material has no properties with alpha components.");return this.add({startObject:{alpha:e(t.startValue,0)},stopObject:{alpha:e(t.stopValue,1)},duration:e(t.duration,3),delay:t.delay,easingFunction:t.easingFunction,update:function(t){for(var e=i.length,n=0;n<e;++n)r.uniforms[i[n]].alpha=t.alpha},complete:t.complete,cancel:t.cancel})},c.prototype.addOffsetIncrement=function(t){var r=(t=e(t,e.EMPTY_OBJECT)).material;if(!n(r))throw new o("material is required.");if(!n(r.uniforms.offset))throw new o("material.uniforms must have an offset property.");var i=r.uniforms;return this.addProperty({object:i,property:"offset",startValue:i.offset,stopValue:i.offset+1,duration:t.duration,delay:t.delay,easingFunction:t.easingFunction,update:t.update,cancel:t.cancel,_repeat:1/0})},c.prototype.remove=function(t){if(!n(t))return!1;var e=this._tweens.indexOf(t);return-1!==e&&(t.tweenjs.stop(),n(t.cancel)&&t.cancel(),this._tweens.splice(e,1),!0)},c.prototype.removeAll=function(){for(var t=this._tweens,e=0;e<t.length;++e){var r=t[e];r.tweenjs.stop(),n(r.cancel)&&r.cancel()}t.length=0},c.prototype.contains=function(t){return n(t)&&-1!==this._tweens.indexOf(t)},c.prototype.get=function(t){if(!n(t))throw new o("index is required.");return this._tweens[t]},c.prototype.update=function(t){var e=this._tweens,r=0;for(t=n(t)?t/s.SECONDS_PER_MILLISECOND:a();r<e.length;){var o=e[r],i=o.tweenjs;o.needsStart?(o.needsStart=!1,i.start(t)):i.update(t)?r++:(i.stop(),e.splice(r,1))}},c});