define(["../Core/Check","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Event","../Core/Iso8601","../Core/oneTimeWarning","../Scene/ClassificationType","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./Entity","./Property"],function(t,e,i,n,o,r,s,a,l,h,y,d,p,_,u,c,f){"use strict";var g=new _(e.WHITE),C=new u(!0),m=new u(!0),P=new u(!1),E=new u(e.BLACK),v=new u(p.DISABLED),b=new u(new a),w=new u(d.BOTH);function O(e){t.defined("options.entity",e.entity),t.defined("options.scene",e.scene),t.defined("options.geometryOptions",e.geometryOptions),t.defined("options.geometryPropertyName",e.geometryPropertyName),t.defined("options.observedPropertyNames",e.observedPropertyNames);var i=e.entity,n=e.geometryPropertyName;this._entity=i,this._scene=e.scene,this._fillEnabled=!1,this._isClosed=!1,this._onTerrain=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new l,this._showProperty=void 0,this._materialProperty=void 0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._options=e.geometryOptions,this._geometryPropertyName=n,this._id=n+"-"+i.id,this._observedPropertyNames=e.observedPropertyNames,this._supportsMaterialsforEntitiesOnTerrain=c.supportsMaterialsforEntitiesOnTerrain(e.scene)}return o(O.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!n(this._entity.availability)&&f.isConstant(this._showProperty)&&f.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!n(this._entity.availability)&&f.isConstant(this._showProperty)&&f.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),O.prototype.isOutlineVisible=function(t){var e=this._entity,n=this._outlineEnabled&&e.isAvailable(t)&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t);return i(n,!1)},O.prototype.isFilled=function(t){var e=this._entity,n=this._fillEnabled&&e.isAvailable(t)&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t);return i(n,!1)},O.prototype.createFillGeometryInstance=s.throwInstantiationError,O.prototype.createOutlineGeometryInstance=s.throwInstantiationError,O.prototype.isDestroyed=function(){return!1},O.prototype.destroy=function(){r(this)},O.prototype._isHidden=function(t,e){var i=e.show;return n(i)&&i.isConstant&&!i.getValue(h.MINIMUM_VALUE)},O.prototype._isOnTerrain=function(t,e){return!1},O.prototype._getIsClosed=function(t){return!0},O.prototype._isDynamic=s.throwInstantiationError,O.prototype._setStaticOptions=s.throwInstantiationError,O.prototype._onEntityPropertyChanged=function(t,e,o,r){if(-1!==this._observedPropertyNames.indexOf(e)){var s=this._entity[this._geometryPropertyName];if(n(s)){var a=s.fill,l=!n(a)||!a.isConstant||a.getValue(h.MINIMUM_VALUE),d=s.outline,p=n(d);if(p&&d.isConstant&&(p=d.getValue(h.MINIMUM_VALUE)),l||p){var u=s.show;if(this._isHidden(t,s))(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));else{this._materialProperty=i(s.material,g),this._fillProperty=i(a,m),this._showProperty=i(u,C),this._showOutlineProperty=i(s.outline,P),this._outlineColorProperty=p?i(s.outlineColor,E):void 0,this._shadowsProperty=i(s.shadows,v),this._distanceDisplayConditionProperty=i(s.distanceDisplayCondition,b),this._classificationTypeProperty=i(s.classificationType,w),this._fillEnabled=l;var c=this._isOnTerrain(t,s)&&(this._supportsMaterialsforEntitiesOnTerrain||this._materialProperty instanceof _);if(p&&c&&(y(y.geometryOutlines),p=!1),this._onTerrain=c,this._outlineEnabled=p,this._isDynamic(t,s))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{this._setStaticOptions(t,s),this._isClosed=this._getIsClosed(this._options);var f=s.outlineWidth;this._outlineWidth=n(f)?f.getValue(h.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}}}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},O.prototype.createDynamicUpdater=function(e,i){if(t.defined("primitives",e),t.defined("groundPrimitives",i),!this._dynamic)throw new s("This instance does not represent dynamic geometry.");return new this.constructor.DynamicGeometryUpdater(this,e,i)},O});