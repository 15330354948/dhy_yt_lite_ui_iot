define(["../Core/ApproximateTerrainHeights","../Core/Cartesian3","../Core/Check","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/GeometryOffsetAttribute","../Core/Iso8601","../Core/oneTimeWarning","../Scene/GroundPrimitive","../Scene/HeightReference","./CallbackProperty","./ConstantProperty","./GeometryUpdater","./Property","./TerrainOffsetProperty"],function(e,t,r,i,o,n,s,f,p,d,h,y,a,c,u,_,O){"use strict";var g=new c(0);function P(e){u.call(this,e),this._zIndex=0,this._terrainOffsetProperty=void 0}return o(Object.create)&&(P.prototype=Object.create(u.prototype),P.prototype.constructor=P),n(P.prototype,{zIndex:{get:function(){return this._zIndex}},terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),P.prototype._isOnTerrain=function(e,t){return this._fillEnabled&&!o(t.height)&&!o(t.extrudedHeight)&&h.isSupported(this._scene)},P.prototype._getIsClosed=function(e){var t=e.height,r=e.extrudedHeight;return 0===t||o(r)&&r!==t},P.prototype._computeCenter=s.throwInstantiationError,P.prototype._onEntityPropertyChanged=function(e,t,r,n){if(u.prototype._onEntityPropertyChanged.call(this,e,t,r,n),-1!==this._observedPropertyNames.indexOf(t)){var s=this._entity[this._geometryPropertyName];if(o(s)){o(s.zIndex)&&(o(s.height)||o(s.extrudedHeight))&&d(d.geometryZIndex),this._zIndex=i(s.zIndex,g),o(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);var f=s.heightReference,p=s.extrudedHeightReference;if(o(f)||o(p)){var h=new a(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new O(this._scene,h,f,p)}}}},P.prototype.destroy=function(){o(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0),u.prototype.destroy.call(this)},P.getGeometryHeight=function(e,t){if(r.defined("heightReference",t),o(e))return t!==y.CLAMP_TO_GROUND?e:0;t!==y.NONE&&d(d.geometryHeightReference)},P.getGeometryExtrudedHeight=function(e,t){if(r.defined("extrudedHeightReference",t),o(e))return t!==y.CLAMP_TO_GROUND?e:P.CLAMP_TO_GROUND;t!==y.NONE&&d(d.geometryExtrudedHeightReference)},P.CLAMP_TO_GROUND="clamp",P.computeGeometryOffsetAttribute=function(e,t,r,i){o(e)&&o(t)||(t=y.NONE),o(r)&&o(i)||(i=y.NONE);var n=0;return t!==y.NONE&&n++,i===y.RELATIVE_TO_GROUND&&n++,2===n?f.ALL:1===n?f.TOP:void 0},P});