define(["../ThirdParty/sprintf","./binarySearch","./defaultValue","./defined","./DeveloperError","./GregorianDate","./isLeapYear","./LeapSecond","./TimeConstants","./TimeStandard"],function(e,n,r,t,a,i,o,s,d,u){"use strict";var f=new i,w=[31,28,31,30,31,30,31,31,30,31,30,31];function c(e,n){return _.compare(e.julianDate,n.julianDate)}var l=new s;function D(e){l.julianDate=e;var r=_.leapSeconds,t=n(r,l,c);t<0&&(t=~t),t>=r.length&&(t=r.length-1);var a=r[t].offset;t>0&&(_.secondsDifference(r[t].julianDate,e)>a&&(a=r[--t].offset));_.addSeconds(e,a,e)}function h(e,r){l.julianDate=e;var t=_.leapSeconds,a=n(t,l,c);if(a<0&&(a=~a),0===a)return _.addSeconds(e,-t[0].offset,r);if(a>=t.length)return _.addSeconds(e,-t[a-1].offset,r);var i=_.secondsDifference(t[a].julianDate,e);return 0===i?_.addSeconds(e,-t[a].offset,r):i<=1?void 0:_.addSeconds(e,-t[--a].offset,r)}function T(e,n,r){var t=n/d.SECONDS_PER_DAY|0;return e+=t,(n-=d.SECONDS_PER_DAY*t)<0&&(e--,n+=d.SECONDS_PER_DAY),r.dayNumber=e,r.secondsOfDay=n,r}function y(e,n,r,t,a,i,o){var s=(n-14)/12|0,u=e+4800+s,f=(1461*u/4|0)+(367*(n-2-12*s)/12|0)-(3*((u+100)/100|0)/4|0)+r-32075;(t-=12)<0&&(t+=24);var w=i+(t*d.SECONDS_PER_HOUR+a*d.SECONDS_PER_MINUTE+o*d.SECONDS_PER_MILLISECOND);return w>=43200&&(f-=1),[f,w]}var S=/^(\d{4})$/,m=/^(\d{4})-(\d{2})$/,E=/^(\d{4})-?(\d{3})$/,O=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,N=/^(\d{4})-?(\d{2})-?(\d{2})$/,I=/([Z+\-])?(\d{2})?:?(\d{2})?$/,C=/^(\d{2})(\.\d+)?/.source+I.source,p=/^(\d{2}):?(\d{2})(\.\d+)?/.source+I.source,v=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+I.source,A="Invalid ISO 8601 date.";function _(e,n,t){this.dayNumber=void 0,this.secondsOfDay=void 0,e=r(e,0),n=r(n,0),t=r(t,u.UTC);var a=0|e;T(a,n+=(e-a)*d.SECONDS_PER_DAY,this),t===u.UTC&&D(this)}_.fromGregorianDate=function(e,n){if(!(e instanceof i))throw new a("date must be a valid GregorianDate.");var r=y(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return t(n)?(T(r[0],r[1],n),D(n),n):new _(r[0],r[1],u.UTC)},_.fromDate=function(e,n){if(!(e instanceof Date)||isNaN(e.getTime()))throw new a("date must be a valid JavaScript Date.");var r=y(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return t(n)?(T(r[0],r[1],n),D(n),n):new _(r[0],r[1],u.UTC)},_.fromIso8601=function(e,n){if("string"!=typeof e)throw new a(A);var r,i,s,d,f,c=(e=e.replace(",",".")).split("T"),l=1,h=1,I=0,g=0,q=0,U=0,b=c[0],R=c[1];if(!t(b))throw new a(A);if(null!==(c=b.match(N))){if((d=b.split("-").length-1)>0&&2!==d)throw new a(A);r=+c[1],l=+c[2],h=+c[3]}else if(null!==(c=b.match(m)))r=+c[1],l=+c[2];else if(null!==(c=b.match(S)))r=+c[1];else{var P;if(null!==(c=b.match(E))){if(r=+c[1],P=+c[2],s=o(r),P<1||s&&P>366||!s&&P>365)throw new a(A)}else{if(null===(c=b.match(O)))throw new a(A);r=+c[1];var j=+c[2],M=+c[3]||0;if((d=b.split("-").length-1)>0&&(!t(c[3])&&1!==d||t(c[3])&&2!==d))throw new a(A);P=7*j+M-new Date(Date.UTC(r,0,4)).getUTCDay()-3}(i=new Date(Date.UTC(r,0,1))).setUTCDate(P),l=i.getUTCMonth()+1,h=i.getUTCDate()}if(s=o(r),l<1||l>12||h<1||(2!==l||!s)&&h>w[l-1]||s&&2===l&&h>29)throw new a(A);if(t(R)){if(null!==(c=R.match(v))){if((d=R.split(":").length-1)>0&&2!==d&&3!==d)throw new a(A);I=+c[1],g=+c[2],q=+c[3],U=1e3*+(c[4]||0),f=5}else if(null!==(c=R.match(p))){if((d=R.split(":").length-1)>2)throw new a(A);I=+c[1],g=+c[2],q=60*+(c[3]||0),f=4}else{if(null===(c=R.match(C)))throw new a(A);I=+c[1],g=60*+(c[2]||0),f=3}if(g>=60||q>=61||I>24||24===I&&(g>0||q>0||U>0))throw new a(A);var Y=c[f],L=+c[f+1],G=+(c[f+2]||0);switch(Y){case"+":I-=L,g-=G;break;case"-":I+=L,g+=G;break;case"Z":break;default:g+=new Date(Date.UTC(r,l-1,h,I,g)).getTimezoneOffset()}}var H=60===q;for(H&&q--;g>=60;)g-=60,I++;for(;I>=24;)I-=24,h++;for(i=s&&2===l?29:w[l-1];h>i;)h-=i,++l>12&&(l-=12,r++),i=s&&2===l?29:w[l-1];for(;g<0;)g+=60,I--;for(;I<0;)I+=24,h--;for(;h<1;)--l<1&&(l+=12,r--),h+=i=s&&2===l?29:w[l-1];var $=y(r,l,h,I,g,q,U);return t(n)?(T($[0],$[1],n),D(n)):n=new _($[0],$[1],u.UTC),H&&_.addSeconds(n,1,n),n},_.now=function(e){return _.fromDate(new Date,e)};var g=new _(0,0,u.TAI);return _.toGregorianDate=function(e,n){if(!t(e))throw new a("julianDate is required.");var r=!1,o=h(e,g);t(o)||(_.addSeconds(e,-1,g),o=h(g,g),r=!0);var s=o.dayNumber,u=o.secondsOfDay;u>=43200&&(s+=1);var f=s+68569|0,w=4*f/146097|0,c=4e3*((f=f-((146097*w+3)/4|0)|0)+1)/1461001|0,l=80*(f=f-(1461*c/4|0)+31|0)/2447|0,D=f-(2447*l/80|0)|0,T=l+2-12*(f=l/11|0)|0,y=100*(w-49)+c+f|0,S=u/d.SECONDS_PER_HOUR|0,m=u-S*d.SECONDS_PER_HOUR,E=m/d.SECONDS_PER_MINUTE|0,O=0|(m-=E*d.SECONDS_PER_MINUTE),N=(m-O)/d.SECONDS_PER_MILLISECOND;return(S+=12)>23&&(S-=24),r&&(O+=1),t(n)?(n.year=y,n.month=T,n.day=D,n.hour=S,n.minute=E,n.second=O,n.millisecond=N,n.isLeapSecond=r,n):new i(y,T,D,S,E,O,N,r)},_.toDate=function(e){if(!t(e))throw new a("julianDate is required.");var n=_.toGregorianDate(e,f),r=n.second;return n.isLeapSecond&&(r-=1),new Date(Date.UTC(n.year,n.month-1,n.day,n.hour,n.minute,r,n.millisecond))},_.toIso8601=function(n,r){if(!t(n))throw new a("julianDate is required.");var i,o=_.toGregorianDate(n,f),s=o.year,d=o.month,u=o.day,w=o.hour,c=o.minute,l=o.second,D=o.millisecond;return 1e4===s&&1===d&&1===u&&0===w&&0===c&&0===l&&0===D&&(s=9999,d=12,u=31,w=24),t(r)||0===D?t(r)&&0!==r?(i=(.01*D).toFixed(r).replace(".","").slice(0,r),e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",s,d,u,w,c,l,i)):e("%04d-%02d-%02dT%02d:%02d:%02dZ",s,d,u,w,c,l):(i=(.01*D).toString().replace(".",""),e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",s,d,u,w,c,l,i))},_.clone=function(e,n){if(t(e))return t(n)?(n.dayNumber=e.dayNumber,n.secondsOfDay=e.secondsOfDay,n):new _(e.dayNumber,e.secondsOfDay,u.TAI)},_.compare=function(e,n){if(!t(e))throw new a("left is required.");if(!t(n))throw new a("right is required.");var r=e.dayNumber-n.dayNumber;return 0!==r?r:e.secondsOfDay-n.secondsOfDay},_.equals=function(e,n){return e===n||t(e)&&t(n)&&e.dayNumber===n.dayNumber&&e.secondsOfDay===n.secondsOfDay},_.equalsEpsilon=function(e,n,r){if(!t(r))throw new a("epsilon is required.");return e===n||t(e)&&t(n)&&Math.abs(_.secondsDifference(e,n))<=r},_.totalDays=function(e){if(!t(e))throw new a("julianDate is required.");return e.dayNumber+e.secondsOfDay/d.SECONDS_PER_DAY},_.secondsDifference=function(e,n){if(!t(e))throw new a("left is required.");if(!t(n))throw new a("right is required.");return(e.dayNumber-n.dayNumber)*d.SECONDS_PER_DAY+(e.secondsOfDay-n.secondsOfDay)},_.daysDifference=function(e,n){if(!t(e))throw new a("left is required.");if(!t(n))throw new a("right is required.");return e.dayNumber-n.dayNumber+(e.secondsOfDay-n.secondsOfDay)/d.SECONDS_PER_DAY},_.computeTaiMinusUtc=function(e){l.julianDate=e;var r=_.leapSeconds,t=n(r,l,c);return t<0&&(t=~t,--t<0&&(t=0)),r[t].offset},_.addSeconds=function(e,n,r){if(!t(e))throw new a("julianDate is required.");if(!t(n))throw new a("seconds is required.");if(!t(r))throw new a("result is required.");return T(e.dayNumber,e.secondsOfDay+n,r)},_.addMinutes=function(e,n,r){if(!t(e))throw new a("julianDate is required.");if(!t(n))throw new a("minutes is required.");if(!t(r))throw new a("result is required.");var i=e.secondsOfDay+n*d.SECONDS_PER_MINUTE;return T(e.dayNumber,i,r)},_.addHours=function(e,n,r){if(!t(e))throw new a("julianDate is required.");if(!t(n))throw new a("hours is required.");if(!t(r))throw new a("result is required.");var i=e.secondsOfDay+n*d.SECONDS_PER_HOUR;return T(e.dayNumber,i,r)},_.addDays=function(e,n,r){if(!t(e))throw new a("julianDate is required.");if(!t(n))throw new a("days is required.");if(!t(r))throw new a("result is required.");return T(e.dayNumber+n,e.secondsOfDay,r)},_.lessThan=function(e,n){return _.compare(e,n)<0},_.lessThanOrEquals=function(e,n){return _.compare(e,n)<=0},_.greaterThan=function(e,n){return _.compare(e,n)>0},_.greaterThanOrEquals=function(e,n){return _.compare(e,n)>=0},_.prototype.clone=function(e){return _.clone(this,e)},_.prototype.equals=function(e){return _.equals(this,e)},_.prototype.equalsEpsilon=function(e,n){return _.equalsEpsilon(this,e,n)},_.prototype.toString=function(){return _.toIso8601(this)},_.leapSeconds=[new s(new _(2441317,43210,u.TAI),10),new s(new _(2441499,43211,u.TAI),11),new s(new _(2441683,43212,u.TAI),12),new s(new _(2442048,43213,u.TAI),13),new s(new _(2442413,43214,u.TAI),14),new s(new _(2442778,43215,u.TAI),15),new s(new _(2443144,43216,u.TAI),16),new s(new _(2443509,43217,u.TAI),17),new s(new _(2443874,43218,u.TAI),18),new s(new _(2444239,43219,u.TAI),19),new s(new _(2444786,43220,u.TAI),20),new s(new _(2445151,43221,u.TAI),21),new s(new _(2445516,43222,u.TAI),22),new s(new _(2446247,43223,u.TAI),23),new s(new _(2447161,43224,u.TAI),24),new s(new _(2447892,43225,u.TAI),25),new s(new _(2448257,43226,u.TAI),26),new s(new _(2448804,43227,u.TAI),27),new s(new _(2449169,43228,u.TAI),28),new s(new _(2449534,43229,u.TAI),29),new s(new _(2450083,43230,u.TAI),30),new s(new _(2450630,43231,u.TAI),31),new s(new _(2451179,43232,u.TAI),32),new s(new _(2453736,43233,u.TAI),33),new s(new _(2454832,43234,u.TAI),34),new s(new _(2456109,43235,u.TAI),35),new s(new _(2457204,43236,u.TAI),36),new s(new _(2457754,43237,u.TAI),37)],_});